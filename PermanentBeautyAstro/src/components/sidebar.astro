---
import serviceGroups from '../data/services';

// Create URL-friendly slugs from service group names
function createSlug(name: string): string {
    return name.toLowerCase().replace(/\s+/g, '-');
}
---

<aside class="sidebar card shadow-sm">
    <nav class="sidebar-nav p-3 pe-lg-10 ps-lg-4 py-lg-4">
        <h3 class="sidebar-title fs-5 mb-3 pb-3 border-bottom">Our Services</h3>
        <ul class="list-unstyled mb-0">
            {serviceGroups.map((group) => (
                <li class="mb-2">
                    <a href={`/services/${createSlug(group.name)}`} class="group-link d-block px-3 py-2 rounded fw-semibold text-decoration-none">
                        {group.name}
                    </a>
                    <ul class="services-submenu list-unstyled ps-3 mb-0">
                        {group.services.map((service) => (
                            <li>
                                <a href={`/services/${createSlug(group.name)}#${createSlug(service.title)}`} 
                                   class="service-link d-block px-3 py-2 rounded text-decoration-none">
                                    {service.title}
                                </a>
                            </li>
                        ))}
                    </ul>
                </li>
            ))}
        </ul>
    </nav>
</aside>

<style>
    /* ===================================
       Sidebar Component
       =================================== */
    .sidebar {
        position: sticky;
        top: 80px;
        max-height: calc(100vh - 100px);
        overflow-y: auto;
    }

    .sidebar-title {
        color: var(--color-primary);
    }

    .group-link {
        color: var(--color-secondary);
        transition: all var(--transition-speed);
        background-color: transparent;
    }

    .group-link:hover {
        background-color: var(--color-bg-light);
        color: var(--color-primary);
        transform: translateX(5px);
    }

    /* Submenu styles */
    .services-submenu {
        max-height: 0;
        overflow: hidden;
        opacity: 0;
        transition: all 0.3s ease;
    }

    li:hover > .services-submenu {
        max-height: 500px;
        opacity: 1;
        margin-top: 0.5rem;
        margin-bottom: 0.5rem;
    }

    .service-link {
        color: var(--color-text-light);
        font-size: 0.95rem;
        transition: all var(--transition-speed);
        border-left: 2px solid transparent;
    }

    .service-link:hover {
        color: var(--color-primary);
        background-color: var(--color-bg-light);
        border-left-color: var(--color-primary);
        padding-left: 1rem !important;
    }

    /* Active state */
    .group-link.active {
        background-color: var(--color-primary);
        color: var(--color-accent);
    }

    .service-link.active {
        color: var(--color-primary);
        background-color: var(--color-bg-light);
        border-left-color: var(--color-primary);
        font-weight: 600;
    }

    /* Scrollbar styling */
    .sidebar::-webkit-scrollbar {
        width: 6px;
    }

    .sidebar::-webkit-scrollbar-track {
        background: var(--color-bg-light);
        border-radius: 3px;
    }

    .sidebar::-webkit-scrollbar-thumb {
        background: var(--color-border);
        border-radius: 3px;
    }

    .sidebar::-webkit-scrollbar-thumb:hover {
        background: var(--color-text-light);
    }
</style>
